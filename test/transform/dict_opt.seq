class DummyDict[K, V]:
    def __getitem__(self, k: K):
        raise ValueError('failed')
        return V()
    def get(self, k: K, d: V):
        raise ValueError('failed')
        return V()
    def __setitem__(self, k: K, v: V):
        assert False
    def __dict_do_op_throws__[F, Z](self, key: K, other: Z, op: F):
        pass
    def __dict_do_op__[F, Z](self, key: K, other: Z, dflt: V, op: F):
        pass

@test
def test_dict_op():
    x = DummyDict[int, int]()
    x[1] = x[1] + 1
    x[1] = x.get(1, 1) + 1

test_dict_op()

@test
def test_dict_do_not_op():
    x = DummyDict[int, int]()
    try:
        x[1] = x[2] + 1
    except ValueError:
        return
    assert False

test_dict_do_not_op()